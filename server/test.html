<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
test
</body>
<script>
    let timeout = 0; // declare outside websocket function
    let conn = new WebSocket('ws://127.0.0.1:8988');
    var timeoutInterval;
    var playerId;

    function resetAndReconnect() {
        clearInterval(timeoutInterval); // stop the interval
        timeout = 0; // reset timeout
        conn.close(); // close current connection
        conn = new WebSocket('ws://127.0.0.1:8988'); // reconnect
    }

    function checkTimeout(){
        timeout++; // increment the timeout by 1
        console.log(timeout); // to see the increment in console

        if (timeout > 10) {
            resetAndReconnect();
        }
    }


    conn.onopen = function(){
        timeoutInterval = setInterval(checkTimeout, 1000);
        console.log("WebSocket connection opened!");

    }
    conn.onmessage = function(e) {
        console.log(e.data);
        var msg = JSON.parse(e.data);
        switch (msg.type){
            case "welcome":
                let response = {
                    type: 'registration',
                    data: 'player1'
                }
                conn.send(JSON.stringify(response));
                break;
            case "registration":

                playerId = msg.data;
                break;
            case "info":
                break;
            case "ping":
                timeout = 0;
                break;
            case "state":
                break;
        }
    }
    conn.onerror = function(e) {
        console.error("WebSocket error observed:", e);
    };
</script>
</html>